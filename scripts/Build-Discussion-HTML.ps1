$m3d2_path = "C:\Users\hellw\OneDrive - Colorado Community College System\COM120\Module-3\M3D2_Practice-Discussion"

Write-Host 'Cleaning LaTeX Project'
Remove-Item "$m3d2_path\*_temp.tex"
Remove-Item "$m3d2_path\*.aux"
Remove-Item "$m3d2_path\*.4ct"
Remove-Item "$m3d2_path\*.4tc"
Remove-Item "$m3d2_path\*.dvi"
Remove-Item "$m3d2_path\*.idv"
Remove-Item "$m3d2_path\*.lg"
Remove-Item "$m3d2_path\*.out.ps"
Remove-Item "$m3d2_path\*.tmp"
Remove-Item "$m3d2_path\*.xref"
Remove-Item "$m3d2_path\*.bbl"
Remove-Item "$m3d2_path\*.bcf"
Remove-Item "$m3d2_path\*.blg"
Remove-Item "$m3d2_path\*.idx"
Remove-Item "$m3d2_path\*.ind"
Remove-Item "$m3d2_path\*.lof"
Remove-Item "$m3d2_path\*.lot"
Remove-Item "$m3d2_path\*.out"
Remove-Item "$m3d2_path\*.toc"
Remove-Item "$m3d2_path\*.acn"
Remove-Item "$m3d2_path\*.acr"
Remove-Item "$m3d2_path\*.alg"
Remove-Item "$m3d2_path\*.glg"
Remove-Item "$m3d2_path\*.glo"
Remove-Item "$m3d2_path\*.gls"
Remove-Item "$m3d2_path\*.ist"
Remove-Item "$m3d2_path\*.fls"
Remove-Item "$m3d2_path\*.log"
Remove-Item "$m3d2_path\*.fdb_latexmk"
Remove-Item "$m3d2_path\*.synctex.gz"
Remove-Item "$m3d2_path\*.lol"
Remove-Item "$m3d2_path\*.run.xml"
Remove-Item "$m3d2_path\*.pdf"

Write-Host 'Building LaTeX Project'
& 'C:\Program Files\MiKTeX\miktex\bin\x64\make4ht.exe' `
  'main.tex' `
  '",charset=utf-8" "-cunihtf -utf8"' `
  '' `
  '"-interaction=nonstopmode"'
& 'C:\Program Files\MiKTeX\miktex\bin\x64\biber.exe' `
  'main'

Write-Host 'Cleaning Project Directory'
Remove-Item "$m3d2_path\*_temp.tex"
Remove-Item "$m3d2_path\*.aux"
Remove-Item "$m3d2_path\*.4ct"
Remove-Item "$m3d2_path\*.4tc"
Remove-Item "$m3d2_path\*.dvi"
Remove-Item "$m3d2_path\*.idv"
Remove-Item "$m3d2_path\*.lg"
Remove-Item "$m3d2_path\*.out.ps"
Remove-Item "$m3d2_path\*.tmp"
Remove-Item "$m3d2_path\*.xref"
Remove-Item "$m3d2_path\*.bbl"
Remove-Item "$m3d2_path\*.bcf"
Remove-Item "$m3d2_path\*.blg"
Remove-Item "$m3d2_path\*.idx"
Remove-Item "$m3d2_path\*.ind"
Remove-Item "$m3d2_path\*.lof"
Remove-Item "$m3d2_path\*.lot"
Remove-Item "$m3d2_path\*.out"
Remove-Item "$m3d2_path\*.toc"
Remove-Item "$m3d2_path\*.acn"
Remove-Item "$m3d2_path\*.acr"
Remove-Item "$m3d2_path\*.alg"
Remove-Item "$m3d2_path\*.glg"
Remove-Item "$m3d2_path\*.glo"
Remove-Item "$m3d2_path\*.gls"
Remove-Item "$m3d2_path\*.ist"
Remove-Item "$m3d2_path\*.fls"
Remove-Item "$m3d2_path\*.log"
Remove-Item "$m3d2_path\*.fdb_latexmk"
Remove-Item "$m3d2_path\*.synctex.gz"
Remove-Item "$m3d2_path\*.lol"
Remove-Item "$m3d2_path\*.run.xml"
